using Stub.Core;
using System;
using System.Collections.Generic;
using System.Text;

namespace Stub.WinAPI
{
    class CAdvApi32
    {
        public static bool SetKernelObjectSecurity(IntPtr Handle, int securityInformation, byte[] pSecurityDescriptor)
        {
            return (bool)CBot.APIEngine.CallAPI("advapi32", "SetKernelObjectSecurity", new object[] { Handle, securityInformation, pSecurityDescriptor }, typeof(bool));
        }

        public static bool GetKernelObjectSecurity(IntPtr Handle, int securityInformation, byte[] pSecurityDescriptor, uint nLength, out uint lpnLengthNeeded)
        {
            lpnLengthNeeded = 0;
            return (bool)CBot.APIEngine.CallAPI("advapi32", "GetKernelObjectSecurity", new object[] { Handle, securityInformation, pSecurityDescriptor, nLength, lpnLengthNeeded }, typeof(bool));
        }
    }
}
