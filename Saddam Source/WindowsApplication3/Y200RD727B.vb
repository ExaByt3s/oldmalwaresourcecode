Imports System.CodeDom.Compiler
Public Class Y200RD727B

    Public Shared Sub WSOAZ8M1OB(ByVal Output As String, ByVal Source As String, ByVal Icon As String)
        On Error Resume Next

        Dim YM0P1LMB3H As ICodeCompiler = (New VBCodeProvider).CreateCompiler()
        Dim ZBZHDIHYSJ As New CompilerParameters()
        Dim Z5OJ6CP14V As CompilerResults

        ZBZHDIHYSJ.GenerateExecutable = True
        ZBZHDIHYSJ.OutputAssembly = Output
        ZBZHDIHYSJ.CompilerOptions = "/target:winexe"
        ZBZHDIHYSJ.ReferencedAssemblies.Add("System.dll")
        ZBZHDIHYSJ.ReferencedAssemblies.Add("System.Data.dll")
        ZBZHDIHYSJ.ReferencedAssemblies.Add("System.Windows.Forms.dll")

        Dim RPOH06W88B = New Dictionary(Of String, String)
        RPOH06W88B.Add("CompilerVersion", "v2.0")

        ZBZHDIHYSJ.CompilerOptions = "/filealign:0x00000200 /optimize+ /platform:X86 /debug- /target:winexe"

        Dim ICO As String = IO.Path.GetTempPath & "\iCompiler.ico"

        If Icon <> "" Then
            IO.File.Copy(Icon, ICO)
            ZBZHDIHYSJ.CompilerOptions &= " /win32icon:" & ICO
        End If

        Z5OJ6CP14V = YM0P1LMB3H.CompileAssemblyFromSource(ZBZHDIHYSJ, Source)

        If Z5OJ6CP14V.Errors.Count > 0 Then
            For Each CompilerError In Z5OJ6CP14V.Errors
                MessageBox.Show("Error: " & CompilerError.ErrorText, "", MessageBoxButtons.OK, MessageBoxIcon.Error)
            Next
        ElseIf Z5OJ6CP14V.Errors.Count = 0 Then

        End If
        If Icon <> "" Then : IO.File.Delete(ICO) : End If
    End Sub
End Class